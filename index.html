<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>æƒŠå–œç›²ç›’</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    @keyframes gradient-shift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.3); }
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Noto Sans SC', sans-serif;
      min-height: 100vh;
      overflow: hidden; 
      /* å›é€€è‰²ï¼Œä¸‡ä¸€èƒŒæ™¯å±‚å¤±è´¥ï¼Œæ˜¾ç¤ºè¿™ä¸ª */
      background-color: #6c757d; 
    }

    /* --- ã€ä¿®æ­£ã€‘--- */
    /* ç§»é™¤äº†æ‰€æœ‰ z-index å±æ€§ã€‚
      å †å é¡ºåºå®Œå…¨ç”± HTML å…ƒç´ çš„é¡ºåºå†³å®šã€‚
      æ‰€æœ‰å›¾å±‚éƒ½å¿…é¡»æ˜¯ position: fixedã€‚
    */

    /* å›¾å±‚ 1 (HTMLä¸­ç¬¬ä¸€ä¸ª): åŠ¨æ€èƒŒæ™¯ */
    .background-layer {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      /* z-index: 1; <-- ç§»é™¤ */
      background: linear-gradient(270deg, #fce4ec, #e1bee7, #bbdefb, #e8f5e9);
      background-size: 400% 400%;
      animation: gradient-shift 30s ease infinite;
    }

    /* å›¾å±‚ 2 (HTMLä¸­ç¬¬äºŒä¸ª): åç»­å¼¹çª—çš„å®¹å™¨ */
    #popup-layer {
      position: fixed; 
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      pointer-events: none; /* å…³é”®ï¼šå…è®¸ç‚¹å‡»ç©¿é€åˆ°ä¸‹é¢çš„å¼¹çª—æŒ‰é’® */
      /* z-index: 900; <-- ç§»é™¤ */
    }
    
    /* å›¾å±‚ 3 (HTMLä¸­ç¬¬ä¸‰ä¸ª): åˆå§‹å¼¹çª—é®ç½© (ä¼šç›–ä½å›¾å±‚1å’Œ2) */
    .modal-backdrop {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      /* z-index: 1000; <-- ç§»é™¤ */
    }

    .modal-backdrop[aria-hidden="true"] {
      display: none;
    }

    /* åˆå§‹å¼¹çª—å†…å®¹ (å®ƒåœ¨é®ç½© *å†…éƒ¨*, æ‰€ä»¥å¤©ç„¶åœ¨é®ç½©ä¸Š) */
    .modal {
      background-color: #ffffff;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      width: 90%;
      max-width: 400px;
      overflow: hidden;
      /* z-index: 1001; <-- ç§»é™¤ (ä¸éœ€è¦) */
    }

    /* --- [å…¶ä»–æ ·å¼ä¿æŒä¸å˜] --- */
    .modal .titlebar { display: flex; align-items: center; padding: 12px 16px; border-bottom: 1px solid #e9ecef; background-color: #f8f9fa; }
    .modal .titlebar .icon { font-size: 20px; margin-right: 8px; }
    .modal .titlebar .title { font-size: 18px; font-weight: 600; color: #343a40; }
    .modal .content { padding: 20px 16px; font-size: 16px; color: #495057; text-align: center; }
    .modal .actions { display: flex; justify-content: flex-end; padding: 12px 16px; border-top: 1px solid #e9ecef; background-color: #f8f9fa; }
    .modal .btn { padding: 8px 20px; border: none; border-radius: 5px; font-size: 15px; cursor: pointer; transition: background-color 0.2s ease; }
    .modal .btn.primary { background-color: #007bff; color: #ffffff; }
    .modal .btn.primary:hover { background-color: #0056b3; }

    .popup-message {
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      padding: 10px 15px;
      position: absolute;
      pointer-events: auto; /* å…³é”®ï¼šå­å…ƒç´ å¿…é¡»å¯äº¤äº’ */
      width: auto;
      white-space: nowrap;
      text-align: center;
      opacity: 0;
      transform: translate(-50%, -50%) scale(0.8) translateY(20px);
      transition: opacity 0.8s ease-out, transform 0.8s ease-out;
      /* z-index ä¹Ÿä¸éœ€è¦ï¼Œå®ƒç›¸å¯¹äºçˆ¶å…ƒç´  popup-layer */
    }
    
    .popup-message.fade-out {
      opacity: 0;
      transform: translate(-50%, -50%) scale(0.8) translateY(20px);
      transition: opacity 0.6s ease-in, transform 0.6s ease-in;
    }

    .popup-message .titlebar { display: flex; align-items: center; margin-bottom: 5px; }
    .popup-message .titlebar .icon { margin-right: 5px; font-size: 16px; animation: pulse 1.5s ease-in-out infinite; }
    .popup-message .titlebar .title { font-weight: 600; font-size: 15px; }
    .popup-message .content { font-size: 14px; padding: 0; }

    /* å¤šæ ·å¼ */
    .popup-message.style-1 { background-color: #fce4ec; }
    .popup-message.style-1 .titlebar { color: #c2185b; }
    .popup-message.style-1 .content { color: #d81b60; }
    .popup-message.style-2 { background-color: #e3f2fd; }
    .popup-message.style-2 .titlebar { color: #1565c0; }
    .popup-message.style-2 .content { color: #1976d2; }
    .popup-message.style-3 { background-color: #e8f5e9; }
    .popup-message.style-3 .titlebar { color: #2e7d32; }
    .popup-message.style-3 .content { color: #388e3c; }
    .popup-message.style-4 { background-color: #f3e5f5; }
    .popup-message.style-4 .titlebar { color: #6a1b9a; }
    .popup-message.style-4 .content { color: #7b1fa2; }
  </style>
</head>
<body>
  
  <div class="background-layer"></div>

  <div id="popup-layer" aria-live="polite" aria-atomic="false"></div>

  <div class="modal-backdrop" id="start-backdrop" aria-hidden="false">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
      <div class="titlebar">
        <span class="icon">ğŸ</span>
        <span class="title" id="modal-title">æƒŠå–œç›²ç›’</span>
      </div>
      <div class="content">äº²çˆ±çš„ï¼Œæ‚¨æœ‰ä¸€ä»½æƒŠå–œç›²ç›’å¾…å¼€å¯ï¼Œç¡®å®šè¦æ‰“å¼€å—ï¼Ÿ</div>
      <div class="actions">
        <button class="btn primary" id="confirm-btn" autofocus>ç¡®å®š</button>
      </div>
    </div>
  </div>

  <audio id="bgMusic" loop preload="auto">
    <source src="https://sf5-hl-cdn-tos.douyinstatic.com/obj/ies-music/7499771397531503370.mp3" type="audio/mpeg">
  </audio>

  <script>
    const bgMusic = document.getElementById('bgMusic');
    const confirmBtn = document.getElementById('confirm-btn');
    const startBackdrop = document.getElementById('start-backdrop');
    const popupLayer = document.getElementById('popup-layer');

    function playMusic() {
      if (bgMusic && bgMusic.paused) { 
        bgMusic.volume = 0.5; 
        bgMusic.play().catch(error => {
          console.log("éŸ³ä¹æ’­æ”¾å¤±è´¥:", error);
        });
      }
    }

    const messages = [
      "ä»Šå¤©è¿‡å¾—å¼€å¿ƒå˜›ï¼Ÿ", "æœŸå¾…ä¸ä½ ä¸‹æ¬¡ç¾å¥½çš„ç›¸é‡ã€‚", "è¦ç›¸ä¿¡è‡ªå·±å™¢ï¼Œä½ æ˜¯æœ€æ£’çš„ï¼",
      "å¤šå–æ°´å“¦~ è®°å¾—å¥½å¥½ç…§é¡¾è‡ªå·±ã€‚", "å­¦ä¼šçˆ±è‡ªå·±, æ‰èƒ½æ›´å¥½åœ°çˆ±åˆ«äººã€‚", "æ¯å¤©éƒ½è¦å…ƒæ°”æ»¡æ»¡ï¼",
      "æ„¿æ‰€æœ‰çƒ¦æ¼éƒ½çƒŸæ¶ˆäº‘æ•£ã€‚", "ä¿æŒå¾®ç¬‘å‘€, ä¸–ç•Œä¹Ÿä¼šå¯¹ä½ å¾®ç¬‘ã€‚", "æ¯ä¸€å¤©éƒ½æ˜¯æ–°çš„å¼€å§‹, åŠ æ²¹ï¼",
      "ä½ å€¼å¾—æ‰€æœ‰ç¾å¥½çš„äº‹ç‰©ï¼", "çè§†æ¯ä¸€æ¬¡å°ç¡®å¹¸ã€‚", "å¿ƒæ€€é˜³å…‰ï¼Œç”Ÿæ´»å°±ä¼šæ˜äº®ã€‚",
      "ç´¯äº†å°±æ­‡ä¸€æ­‡ã€‚", "ä»Šå¤©ä¹Ÿæ˜¯å¾ˆå¯çˆ±çš„ä¸€å¤©ï¼", "è®°å¾—æŒ‰æ—¶åƒé¥­ã€‚",
      "å°å°çš„è¿›æ­¥ï¼Œä¹Ÿæ˜¯å¤§å¤§çš„æˆå°±ã€‚", "ä¸ç®¡å¤©æ°”æ€æ ·ï¼Œæˆ‘çš„ç¥ç¦å¸¸åœ¨ã€‚", "ä½ æ˜¯ç‹¬ä¸€æ— äºŒçš„ã€‚",
      "æ„¿ä½ ä»Šæ™šæœ‰ä¸ªå¥½æ¢¦ã€‚", "å°ç³å®å®æœ€æ£’äº†ï¼", "åˆ«å¿˜äº†ç»™è‡ªå·±ä¸€ä¸ªå°å°çš„å¥–åŠ±ã€‚",
      "ä½ çš„ç¬‘å®¹æ¯”ç³–æœè¿˜ç”œã€‚", "ç”Ÿæ´»æœ‰ç‚¹å°è‹¦ï¼Œä½†ä½ è¶…ç”œã€‚", "å¥½è¿æ­£åœ¨å‘ä½ é£å¥”è€Œæ¥ï¼",
      "åšè‡ªå·±å–œæ¬¢çš„äº‹ã€‚", "è¢«å­è¦ç›–å¥½ï¼Œä¸è®¸ç€å‡‰å“¦ã€‚", "æƒ³ä½ å•¦ã€‚",
      "æŠŠä¸å¼€å¿ƒéƒ½ä¸¢æ‰ï¼Œå¥½ä¸å¥½ï¼Ÿ", "ä½ åŠªåŠ›çš„æ ·å­ï¼Œè¶…çº§é—ªè€€ã€‚", "å¸Œæœ›æˆ‘çš„å‡ºç°ï¼Œèƒ½è®©ä½ å¼€å¿ƒä¸€ç§’ã€‚",
      "åˆ«æ€•ï¼Œä¸€åˆ‡éƒ½ä¼šå¥½èµ·æ¥çš„ã€‚", "æ™šå®‰ï¼Œæ—©ç‚¹ä¼‘æ¯ã€‚", "ä¸–ç•Œå¾ˆå¤§ï¼Œä½ ä¹Ÿå¾ˆç¾ã€‚",
      "æ¯ä¸€æœµèŠ±å¼€ï¼Œéƒ½æ˜¯ä¸ºä½ ç¥ç¦ã€‚", "åŠ æ²¹ï¼ä½ æ˜¯æœ€é—ªäº®çš„æ˜Ÿæ˜Ÿã€‚", "çˆ±ä½ å“¦ï¼Œä¸æ­¢ä»Šå¤©ã€‚"
    ];

    const icons = ['â¤ï¸', 'âœ¨', 'ğŸ’–', 'ğŸŒŸ', 'ğŸ¥°', 'ğŸ‰', 'ğŸŒ¸', 'ğŸ’«'];
    const styles = ['style-1', 'style-2', 'style-3', 'style-4'];

    if (confirmBtn) {
      confirmBtn.addEventListener('click', () => {
        if (startBackdrop) {
          startBackdrop.setAttribute('aria-hidden', 'true'); 
        }
        playMusic(); 
        showPopupsSequentially();
      });
    } else {
      console.error("é”™è¯¯ï¼šæ— æ³•æ‰¾åˆ° 'confirm-btn' æŒ‰é’®ï¼");
      // ä¸ºäº†è®©æ‚¨èƒ½çœ‹åˆ°é”™è¯¯
      alert("è‡´å‘½é”™è¯¯: æ— æ³•æ‰¾åˆ° 'confirm-btn' æŒ‰é’®ï¼"); 
    }

    function showPopupsSequentially() {
      if (!popupLayer) {
        console.error("é”™è¯¯: æ— æ³•æ‰¾åˆ° 'popup-layer'!");
        return; 
      }

      let delay = 0;
      const usedPositions = []; 

      messages.forEach((msg, index) => {
        let topOffset, leftOffset, positionOK;
        let attempts = 0;
        do {
          topOffset = Math.random() * 70 + 15;
          leftOffset = Math.random() * 70 + 15;
          positionOK = true;
          for (const pos of usedPositions) {
            const dist = Math.sqrt(Math.pow(pos.top - topOffset, 2) + Math.pow(pos.left - leftOffset, 2));
            if (dist < 15 && attempts < 10) { 
              positionOK = false;
              break;
            }
          }
          attempts++;
        } while (!positionOK && attempts < 20); 

        if(usedPositions.length > 10) {
           usedPositions.shift(); 
        }
        usedPositions.push({ top: topOffset, left: leftOffset });

        setTimeout(() => {
          const popup = document.createElement('div');
          popup.className = 'popup-message';
          
          const randomIcon = icons[Math.floor(Math.random() * icons.length)];
          const randomStyle = styles[Math.floor(Math.random() * styles.length)];
          popup.classList.add(randomStyle);
          
          popup.innerHTML = `
            <div class="titlebar">
              <span class="icon">${randomIcon}</span>
              <span class="title">To å°ç³å®å®</span>
            </div>
            <div class="content">${msg}</div>
          `;
          
          popup.style.top = `${topOffset}%`;
          popup.style.left = `${leftOffset}%`;
          const rotation = Math.random() * 10 - 5; 
          
          popupLayer.appendChild(popup);

          void popup.offsetWidth;

          popup.style.opacity = '1';
          popup.style.transform = `translate(-50%, -50%) scale(1) rotate(${rotation}deg)`;
          
          setTimeout(() => {
            popup.classList.add('fade-out');
            popup.addEventListener('transitionend', () => {
              if(popup.parentNode) {
                popup.remove();
              }
            }, { once: true });
          }, 6000); 

        }, delay);
        delay += 800; 
      });
    }
  </script>
</body>
</html>